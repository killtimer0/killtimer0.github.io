<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Hackergame 2021 | 轮子部落</title><meta name="keywords" content="reverse,ctf,pwn,web"><meta name="author" content="KillTimer"><meta name="copyright" content="KillTimer"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="咕咕咕">
<meta property="og:type" content="article">
<meta property="og:title" content="Hackergame 2021">
<meta property="og:url" content="https://killtimer0.github.io/2021/11/04/Hackergame2021/index.html">
<meta property="og:site_name" content="轮子部落">
<meta property="og:description" content="咕咕咕">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg">
<meta property="article:published_time" content="2021-11-04T05:22:47.000Z">
<meta property="article:modified_time" content="2021-11-06T18:36:05.448Z">
<meta property="article:author" content="KillTimer">
<meta property="article:tag" content="reverse">
<meta property="article:tag" content="ctf">
<meta property="article:tag" content="pwn">
<meta property="article:tag" content="web">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://killtimer0.github.io/2021/11/04/Hackergame2021/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'mediumZoom',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Hackergame 2021',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-11-07 02:36:05'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_2790816_84e2ai83qxf.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/l-lin/font-awesome-animation/dist/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.min.css" media="defer" onload="this.media='all'"><script async src="https://cdn.jsdelivr.net/npm/hexo-butterfly-tag-plugins-plus@latest/lib/carousel-touch.min.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/loading.svg" data-original="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">9</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">轮子部落</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">Hackergame 2021</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-11-04T05:22:47.000Z" title="发表于 2021-11-04 13:22:47">2021-11-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-11-06T18:36:05.448Z" title="更新于 2021-11-07 02:36:05">2021-11-07</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BC%96%E7%A8%8B/">编程</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">5.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>24分钟</span></span></div></div></div><article class="post-content" id="article-container"><h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>中科大的比赛, 个人感觉难度挺高, 甚至很多知识技能闻所未闻.<br><a target="_blank" rel="noopener" href="https://hack.lug.ustc.edu.cn/">网站链接</a></p>
<h2 id="进制十六——参上"><a href="#进制十六——参上" class="headerlink" title="进制十六——参上"></a>进制十六——参上</h2><p>一个很典型的十六进制编辑器界面, 左边是十六进制, 右边是字符.</p>
<p><img src="/img/loading.svg" data-original="/pictures/hackergame_2021_hex_1.jpg" alt="题图"></p>
<p>直接对着左边去推右边的flag即可.</p>
<p>淦! 当时对着图抄都能抄错, 而且还抄错好几次, 少一行或者缺个字母. 当时一直觉得flag很奇怪<img no-lazy style="display: inline; zoom: 0.5; margin: 0;" src="/pictures/bili-small-shrink/1/509.png" alt="[笑哭]"></img>.</p>
<blockquote>
<p>在这里推荐一个十六进制编辑器: <a target="_blank" rel="noopener" href="https://mh-nexus.de/en/hxd/">HxD Hex Editor</a><br>这个感觉用起来比较舒服, 可以看16进制表示的整数, 浮点数或者是指令. 可以打开超大文件的同时, 也可以打开磁盘或者<strong>某程序的内存空间</strong>!<br>感觉比WinHex好用, 最重要的是这个不用收费.</p>
</blockquote>
<h2 id="去吧！追寻自由的电波"><a href="#去吧！追寻自由的电波" class="headerlink" title="去吧！追寻自由的电波"></a>去吧！追寻自由的电波</h2><p>flag就在音频里, 但是音频被加速了, 完全听不出来.<br>用PotPlayer打开, 尝试减速, 结果… 声音频率没变, 还是听不出来.<br>那就用GoldWave看看吧, 当年剪一段音频的时候用的就是这个.</p>
<p><img src="/img/loading.svg" data-original="/pictures/hackergame_2021_radio_1.jpg" alt="识别过程"></p>
<p>开0.5倍, 整个音频很清晰. 所有单词除了leftbracket和rightbracket代表左右花括号外, 其他的都是首字母代表译文的一个字母.</p>
<blockquote>
<p>听了一个学长的分享, 这个表达方式叫北约音标字母, <a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%8C%97%E7%BA%A6%E9%9F%B3%E6%A0%87%E5%AD%97%E6%AF%8D/4157760">传送门</a></p>
</blockquote>
<h2 id="卖瓜"><a href="#卖瓜" class="headerlink" title="卖瓜"></a>卖瓜</h2><p>题目要求我们放x个6斤的瓜和y个9斤的瓜, 让称上的结果为20斤.<br>先尝试用小数, 发现小数部分会被截断. 负数也被提示无效输入, What’s up? 然后就把这题跳了.</p>
<p>几天后看这题通过人数, 发现还挺多的, 就再来试试.<br>输入1024819115206086201(因为它等于<code>ceil(LONG_MAX, 9)</code>)看看有什么情况, 发现结果溢出了变成了负数.<br>查找相关资料, php的整数在过大时会自动转换为浮点数, 但是浮点数表示较大整数是有误差的, 而且数越大误差越大.<br>照这个思路, 我们想办法得到一个有误差的大负数, 然后加上一个正数, 就可能让结果为20.<br>然后开始一个一个试, 从1024819115206086201开始的好几百个数, 结果都是-9223372036854775808. 但是这个数表示我们要的, 因为20减去它并不是3的倍数.<br>直到输入1024819115206086600, 结果变成了-9223372036854771712, 这个行了, 然后填入合适的6斤的瓜.<br>$ 20+9223372036854771712=1537228672809128622 \times 6 $.</p>
<p>值得注意的是, 这两个数不能同时填入. 得先填9斤的让结果溢出, 再填上6斤的把数加回来.</p>
<h2 id="透明的文件"><a href="#透明的文件" class="headerlink" title="透明的文件"></a>透明的文件</h2><p>打开文件发现是这么个格式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[0;0H[20;58H[8;34H[13;27H[4;2H[38;2;1;204;177m [39m[14;10H[20;51H[23;4H[12;2H[38;2;2;207;173m </span><br></pre></td></tr></table></figure>
<p>DNA动了! 高三学C时在手机上写了几个控制台小游戏, 清楚地记得这种奇怪的格式.(<a target="_blank" rel="noopener" href="https://www.cnblogs.com/demonxian3/p/8963807.html">传送门</a>)<br>意思就是说, \033(或者\x1e)+左方括号+一堆数字和分隔符+某个字母可以产生一些特别的效果.<br>比如清屏, 光标移动, 字符颜色什么的(甚至unistd.h里面一些宏都是拿printf这么干的).<br>观察一下这个文件, 发现每个左中括号前面的控制字符都不见了, 那就记事本打开把<code>[</code>全替换成<code>\033[</code>, 再把所有空格改成能看见的字符, 空格替换为<code>#</code>.<br>把这个丢到printf里作为格式串, 在linux或者android里面都可以跑出来, 在cmd里面是看不出结果的.</p>
<blockquote>
<p>但是, 在cmd中真的不能看到结果吗?</p>
</blockquote>
<p>在Windows中有一个API <code>SetConsoleMode</code>, 这个API可以设置控制台的某些属性, 我之前写过一个小工具让控制台能够接受鼠标的点击, 它的核心点也是这个.<br>下面是让cmd成功显示flag的代码:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> BOOL <span class="title">enableCtl</span><span class="params">()</span></span>&#123;</span><br><span class="line">    BOOL ret = FALSE;</span><br><span class="line">    HANDLE hStdOut = GetStdHandle(STD_OUTPUT_HANDLE);</span><br><span class="line">    <span class="keyword">if</span> (hStdOut != INVALID_HANDLE_VALUE)&#123;</span><br><span class="line">        DWORD mode;</span><br><span class="line">        <span class="keyword">if</span> (GetConsoleMode(hStdOut, &amp;mode))&#123;</span><br><span class="line">            mode |= ENABLE_LINE_INPUT | ENABLE_ECHO_INPUT;</span><br><span class="line">            ret = SetConsoleMode(hStdOut, mode);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    enableCtl();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;格式化好的字符串, 太长了不贴了, 源码在下面&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<a download href="/archives/hackergame_2021_flag.zip" style="display: block;"><span class="iconfont icon-archive-c"></span>源码</a>
<p>命令行: <code>gcc test.cpp -o test &amp; cls &amp; test &amp; pause &gt; nul</code></p>
<p>运行结果(我习惯白底的cmd, 然后就是这样):<br><img src="/img/loading.svg" data-original="/pictures/hackergame_2021_ansi_1.jpg" alt="flag"></p>
<p>Windows yyds!!!</p>
<h2 id="中间省略一万字"><a href="#中间省略一万字" class="headerlink" title="中间省略一万字"></a>中间省略一万字</h2><p>别问, 问就是不想写<img no-lazy style="display: inline; zoom: 0.5; margin: 0;" src="/pictures/bili-small-shrink/1/20.png" alt="[傲娇]"></img><br><del>其实是不会写</del></p>
<h2 id="Amnesia-1"><a href="#Amnesia-1" class="headerlink" title="Amnesia #1"></a>Amnesia #1</h2><p>写一个Hello world, 但会把你的.data段和.rodata段清除.</p>
<p>.data段存放程序数据, 一般是全局数组之类的; .rodata段存放只读的数据, 像字符串就在此处. 所以你的程序不能出现字符串, 除非换一个段, 比如下面的程序能跑:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">__attribute__((section(<span class="string">&quot;.fake&quot;</span>)))</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">char</span> msg[] = <span class="string">&quot;Hello, world!&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">puts</span>(msg);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但这种方法是很不稳定的. 假如你使用的是<code>printf</code>, 编译器会把你带换行符的<code>msg</code>一并优化为<code>puts(msg2);</code>, 其中msg2是不带换行符的msg. 这样, .fake段就是msg, .rodata段就是msg2, 而优化后的程序使用的是msg2, 所以还是会被清掉.</p>
<p>不使用数据段的话可以这样:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> s[] = &#123;<span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;!&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span> (s); i++) <span class="built_in">putchar</span>(s[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Micro-World"><a href="#Micro-World" class="headerlink" title="Micro World"></a>Micro World</h2><p>用Spy++查看窗口类名, 是pygame, 确定这是python写的. 像这种比较大的程序一般都是脚本打包, 而不是C++写的(Qt什么的就另说).<br>pyinstxtractor解包并修复后, 得到pyc文件. 使用uncompyle6反编译, 成功输出py脚本.<br>然后运行发现是黑框框, 什么都没有???</p>
<p>然后就看源码吧, 把一些不合逻辑的代码改一改, 最后再把速度取反, 就能反向运行啦</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#game.pyw</span></span><br><span class="line"><span class="keyword">import</span> time, pygame, random, math</span><br><span class="line">WIDTH = <span class="number">800</span></span><br><span class="line">HEIGHT = <span class="number">480</span></span><br><span class="line">FPS = <span class="number">30</span></span><br><span class="line">RADIUS = <span class="number">6</span></span><br><span class="line">WHITE = (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>)</span><br><span class="line">BLACK = (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">RED = (<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">GREEN = (<span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>)</span><br><span class="line">BLUE = (<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>)</span><br><span class="line">pygame.init()</span><br><span class="line">pygame.mixer.init()</span><br><span class="line">screen = pygame.display.set_mode((WIDTH, HEIGHT))</span><br><span class="line">pygame.display.set_caption(<span class="string">&#x27;Micro world&#x27;</span>)</span><br><span class="line">clock = pygame.time.Clock()</span><br><span class="line">running = <span class="literal">True</span></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line">list_ = [数据太长不贴了, 源码在下面]</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, pos, vx, vy</span>):</span></span><br><span class="line">        self.x, self.y = pos</span><br><span class="line">        self.vx = vx</span><br><span class="line">        self.vy = vy</span><br><span class="line">        self.flag = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dotproduct</span>(<span class="params">v1, v2</span>):</span></span><br><span class="line">    <span class="keyword">return</span> v1[<span class="number">0</span>] * v2[<span class="number">0</span>] + v1[<span class="number">1</span>] * v2[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">checkcrush</span>(<span class="params">point1, point2</span>):</span></span><br><span class="line">    distance = math.sqrt((point1.x - point2.x) ** <span class="number">2</span> + (point1.y - point2.y) ** <span class="number">2</span>)</span><br><span class="line">    a = (point1.vx - point2.vx) ** <span class="number">2</span> + (point1.vy - point2.vy) ** <span class="number">2</span></span><br><span class="line">    b = <span class="number">2</span> * (point1.x - point2.x) * (point1.vx - point2.vx) + <span class="number">2</span> * (point1.y - point2.y) * (point1.vy - point2.vy)</span><br><span class="line">    c = distance ** <span class="number">2</span> - <span class="number">4</span> * RADIUS ** <span class="number">2</span></span><br><span class="line">    delta = b ** <span class="number">2</span> - <span class="number">4</span> * a * c</span><br><span class="line">    <span class="keyword">if</span> delta &lt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    time = (-b - math.sqrt(delta)) / (<span class="number">2</span> * a)</span><br><span class="line">    <span class="keyword">if</span> time &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> time &lt; <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> time</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_new_point</span>(<span class="params">time, point1, point2</span>):</span></span><br><span class="line">    distance = math.sqrt((point1.x - point2.x) ** <span class="number">2</span> + (point1.y - point2.y) ** <span class="number">2</span>)</span><br><span class="line">    standard_displacement = ((point2.x - point1.x) / distance, (point2.y - point1.y) / distance)</span><br><span class="line">    v_1 = (point1.vx, point1.vy)</span><br><span class="line">    v_2 = (point2.vx, point2.vy)</span><br><span class="line">    v_par_1 = dotproduct(standard_displacement, v_1)</span><br><span class="line">    v_par_2 = dotproduct(standard_displacement, v_2)</span><br><span class="line">    v_ver_1 = (point1.vx - v_par_1 * standard_displacement[<span class="number">0</span>], point1.vy - v_par_1 * standard_displacement[<span class="number">1</span>])</span><br><span class="line">    v_ver_2 = (point2.vx - v_par_2 * standard_displacement[<span class="number">0</span>], point2.vy - v_par_2 * standard_displacement[<span class="number">1</span>])</span><br><span class="line">    v_after_par_1 = v_par_2</span><br><span class="line">    v_after_par_2 = v_par_1</span><br><span class="line">    v_after_1 = (v_after_par_1 * standard_displacement[<span class="number">0</span>] + v_ver_1[<span class="number">0</span>], v_after_par_1 * standard_displacement[<span class="number">1</span>] + v_ver_1[<span class="number">1</span>])</span><br><span class="line">    v_after_2 = (v_after_par_2 * standard_displacement[<span class="number">0</span>] + v_ver_2[<span class="number">0</span>], v_after_par_2 * standard_displacement[<span class="number">1</span>] + v_ver_2[<span class="number">1</span>])</span><br><span class="line">    afterpos_1 = (point1.x + point1.vx * time + v_after_1[<span class="number">0</span>] * (<span class="number">1</span> - time), point1.y + point1.vy * time + v_after_1[<span class="number">1</span>] * (<span class="number">1</span> - time))</span><br><span class="line">    afterpos_2 = (point2.x + point2.vx * time + v_after_2[<span class="number">0</span>] * (<span class="number">1</span> - time), point2.y + point2.vy * time + v_after_2[<span class="number">1</span>] * (<span class="number">1</span> - time))</span><br><span class="line">    <span class="keyword">return</span> (Point(afterpos_1, v_after_1[<span class="number">0</span>], v_after_1[<span class="number">1</span>]), Point(afterpos_2, v_after_2[<span class="number">0</span>], v_after_2[<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">drawpoint</span>(<span class="params">screen, list_</span>):</span></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> list_:</span><br><span class="line">        pygame.draw.circle(screen, BLUE, (<span class="built_in">round</span>(item.x), <span class="built_in">round</span>(item.y)), RADIUS, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">next_pos_list</span>(<span class="params">Pointlist</span>):</span></span><br><span class="line">    pointlist = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Pointlist)):</span><br><span class="line">        <span class="keyword">for</span> point <span class="keyword">in</span> Pointlist[i + <span class="number">1</span>:]:</span><br><span class="line">            times = checkcrush(Pointlist[i], point)</span><br><span class="line">            <span class="keyword">if</span> times != <span class="literal">None</span>:</span><br><span class="line">                a, b = get_new_point(times, Pointlist[i], point)</span><br><span class="line">                pointlist.extend([a, b])</span><br><span class="line">                Pointlist[i].flag = <span class="number">0</span></span><br><span class="line">                point.flag = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> Pointlist:</span><br><span class="line">        <span class="keyword">if</span> item.flag != <span class="number">0</span>:</span><br><span class="line">            pointlist.append(Point((item.x + item.vx, item.y + item.vy), item.vx, item.vy))</span><br><span class="line">        <span class="keyword">for</span> poi <span class="keyword">in</span> pointlist:</span><br><span class="line">            poi.x = poi.x % WIDTH</span><br><span class="line">            poi.y = poi.y % HEIGHT</span><br><span class="line">    <span class="keyword">return</span> pointlist</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Pointlist = []</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> list_.__reversed__():</span><br><span class="line">    Pointlist.append(Point((item[<span class="number">0</span>], item[<span class="number">1</span>]), -item[<span class="number">2</span>], -item[<span class="number">3</span>]))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">value</span>(<span class="params">lis</span>):</span></span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> lis:</span><br><span class="line">            count = count + (item.x - <span class="built_in">round</span>(item.x)) ** <span class="number">2</span> + (item.y - <span class="built_in">round</span>(item.y)) ** <span class="number">2</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> count</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> running:</span><br><span class="line">        clock.tick(FPS)</span><br><span class="line">        <span class="keyword">for</span> event <span class="keyword">in</span> pygame.event.get():</span><br><span class="line">            <span class="keyword">if</span> event.<span class="built_in">type</span> == pygame.QUIT:</span><br><span class="line">                running = <span class="literal">False</span></span><br><span class="line">            screen.fill(BLACK)</span><br><span class="line">            drawpoint(screen, Pointlist)</span><br><span class="line">            Pointlist = next_pos_list(Pointlist)</span><br><span class="line">            pygame.display.flip()</span><br><span class="line"></span><br><span class="line">    pygame.quit()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<a download href="/archives/hackergame_2021_microworld.zip" style="display: block;"><span class="iconfont icon-archive-c"></span>源码</a>
<p>程序运行的结果如下, 不知道为啥只有鼠标放在窗口上面才会运转, 不过这样更好, 容易看出 flag<br><img src="/img/loading.svg" data-original="/pictures/hackergame_2021_microworld_1.jpg" alt="microworld"></p>
<p>uncompyle真jier坑<img no-lazy style="display: inline; zoom: 0.5; margin: 0;" src="/pictures/bili-small-shrink/1/10.png" alt="[生气]"></img></p>
<h2 id="minecRaft"><a href="#minecRaft" class="headerlink" title="minecRaft"></a>minecRaft</h2><p>打开游戏, 没玩懂, 那就直接F12吧, 看到下面的:<br><img src="/img/loading.svg" data-original="/pictures/hackergame_2021_minecraft_1.jpg" alt="资源"><br>保存一下js, 给它格式化:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> _0x22517d = _0x2c9e; (<span class="function"><span class="keyword">function</span>(<span class="params">_0x2018e5, _0xd122c5</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">const</span> _0x4a600d = _0x2c9e,</span><br><span class="line">	_0x2e34d2 = _0x2018e5();</span><br><span class="line">	<span class="keyword">while</span> ( !! []) &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">const</span> _0x4d38c4 = -<span class="built_in">parseInt</span>(_0x4a600d(<span class="number">0x1b1</span>)) / <span class="number">0x1</span> * (<span class="built_in">parseInt</span>(_0x4a600d(<span class="number">0x1ad</span>)) / <span class="number">0x2</span>) + -<span class="built_in">parseInt</span>(_0x4a600d(<span class="number">0x1b2</span>)) / <span class="number">0x3</span> * (<span class="built_in">parseInt</span>(_0x4a600d(<span class="number">0x1b6</span>)) / <span class="number">0x4</span>) + -<span class="built_in">parseInt</span>(_0x4a600d(<span class="number">0x1ae</span>)) / <span class="number">0x5</span> * ( - <span class="built_in">parseInt</span>(_0x4a600d(<span class="number">0x1b4</span>)) / <span class="number">0x6</span>) + <span class="built_in">parseInt</span>(_0x4a600d(<span class="number">0x1ab</span>)) / <span class="number">0x7</span> * (<span class="built_in">parseInt</span>(_0x4a600d(<span class="number">0x1af</span>)) / <span class="number">0x8</span>) + <span class="built_in">parseInt</span>(_0x4a600d(<span class="number">0x1b5</span>)) / <span class="number">0x9</span> + -<span class="built_in">parseInt</span>(_0x4a600d(<span class="number">0x1b3</span>)) / <span class="number">0xa</span> + -<span class="built_in">parseInt</span>(_0x4a600d(<span class="number">0x1a9</span>)) / <span class="number">0xb</span> * ( - <span class="built_in">parseInt</span>(_0x4a600d(<span class="number">0x1a7</span>)) / <span class="number">0xc</span>);</span><br><span class="line">			<span class="keyword">if</span> (_0x4d38c4 === _0xd122c5) <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">else</span> _0x2e34d2[<span class="string">&#x27;push&#x27;</span>](_0x2e34d2[<span class="string">&#x27;shift&#x27;</span>]());</span><br><span class="line">		&#125; <span class="keyword">catch</span>(_0x416145) &#123;</span><br><span class="line">			_0x2e34d2[<span class="string">&#x27;push&#x27;</span>](_0x2e34d2[<span class="string">&#x27;shift&#x27;</span>]());</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125; (_0x381b, <span class="number">0x21c08</span>), <span class="built_in">String</span>[<span class="string">&#x27;prototype&#x27;</span>][_0x22517d(<span class="number">0x1a8</span>)] = <span class="function"><span class="keyword">function</span>(<span class="params">_0x6a2659</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">const</span> _0x13519e = _0x22517d,</span><br><span class="line">	_0x267e12 = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">0x2</span>),</span><br><span class="line">	_0x11a961 = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">0x4</span>);</span><br><span class="line">	<span class="keyword">let</span> _0x1bf548 = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">	plaintext = <span class="built_in">escape</span>(<span class="built_in">this</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">var</span> _0x485827 = <span class="number">0x0</span>; _0x485827 &lt; <span class="number">0x4</span>; _0x485827++) _0x11a961[_0x485827] = Str4ToLong(_0x6a2659[_0x13519e(<span class="number">0x1a6</span>)](_0x485827 * <span class="number">0x4</span>, (_0x485827 + <span class="number">0x1</span>) * <span class="number">0x4</span>));</span><br><span class="line">	<span class="keyword">for</span> (_0x485827 = <span class="number">0x0</span>; _0x485827 &lt; plaintext[_0x13519e(<span class="number">0x1b8</span>)]; _0x485827 += <span class="number">0x8</span>) &#123;</span><br><span class="line">		_0x267e12[<span class="number">0x0</span>] = Str4ToLong(plaintext[<span class="string">&#x27;slice&#x27;</span>](_0x485827, _0x485827 + <span class="number">0x4</span>)),</span><br><span class="line">		_0x267e12[<span class="number">0x1</span>] = Str4ToLong(plaintext[_0x13519e(<span class="number">0x1a6</span>)](_0x485827 + <span class="number">0x4</span>, _0x485827 + <span class="number">0x8</span>)),</span><br><span class="line">		code(_0x267e12, _0x11a961),</span><br><span class="line">		_0x1bf548 += LongToBase16(_0x267e12[<span class="number">0x0</span>]) + LongToBase16(_0x267e12[<span class="number">0x1</span>]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> _0x1bf548;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_0x2c9e</span>(<span class="params">_0x49e6ff, _0x310d40</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">const</span> _0x381b4c = _0x381b();</span><br><span class="line">	<span class="keyword">return</span> _0x2c9e = <span class="function"><span class="keyword">function</span>(<span class="params">_0x2c9ec6, _0x2ec3bd</span>) </span>&#123;</span><br><span class="line">		_0x2c9ec6 = _0x2c9ec6 - <span class="number">0x1a6</span>;</span><br><span class="line">		<span class="keyword">let</span> _0x4769df = _0x381b4c[_0x2c9ec6];</span><br><span class="line">		<span class="keyword">return</span> _0x4769df;</span><br><span class="line">	&#125;,</span><br><span class="line">	_0x2c9e(_0x49e6ff, _0x310d40);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">code</span>(<span class="params">_0x167a71, _0x762113</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">let</span> _0x412874 = _0x167a71[<span class="number">0x0</span>],</span><br><span class="line">	_0x3f9c14 = _0x167a71[<span class="number">0x1</span>];</span><br><span class="line">	<span class="keyword">const</span> _0x540f95 = (<span class="number">0x52cfb2de</span> + <span class="number">0x4b67c6db</span>),</span><br><span class="line">	_0x2bdc23 = _0x540f95 * <span class="number">0x20</span>;</span><br><span class="line">	<span class="keyword">let</span> _0x4f8e47 = <span class="number">0x0</span>;</span><br><span class="line">	<span class="keyword">while</span> (_0x4f8e47 != _0x2bdc23) &#123;</span><br><span class="line">		_0x412874 += (_0x3f9c14 &lt;&lt; <span class="number">0x4</span> ^ _0x3f9c14 &gt;&gt;&gt; <span class="number">0x5</span>) + _0x3f9c14 ^ _0x4f8e47 + _0x762113[_0x4f8e47 &amp; <span class="number">0x3</span>],</span><br><span class="line">		_0x4f8e47 += _0x540f95,</span><br><span class="line">		_0x3f9c14 += (_0x412874 &lt;&lt; <span class="number">0x4</span> ^ _0x412874 &gt;&gt;&gt; <span class="number">0x5</span>) + _0x412874 ^ _0x4f8e47 + _0x762113[_0x4f8e47 &gt;&gt;&gt; <span class="number">0xb</span> &amp; <span class="number">0x3</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	_0x167a71[<span class="number">0x0</span>] = _0x412874,</span><br><span class="line">	_0x167a71[<span class="number">0x1</span>] = _0x3f9c14;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Str4ToLong</span>(<span class="params">_0x288936</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">const</span> _0xf57f33 = _0x22517d;</span><br><span class="line">	<span class="keyword">let</span> _0x283da9 = <span class="number">0x0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">let</span> _0x1bfa1a = <span class="number">0x0</span>; _0x1bfa1a &lt; <span class="number">0x4</span>; _0x1bfa1a++) _0x283da9 |= _0x288936[_0xf57f33(<span class="number">0x1ac</span>)](_0x1bfa1a) &lt;&lt; _0x1bfa1a * <span class="number">0x8</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">isNaN</span>(_0x283da9) ? <span class="number">0x0</span>: _0x283da9;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">LongToBase16</span>(<span class="params">_0xad4470</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">let</span> _0x4176bf = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">let</span> _0x3c7880 = <span class="number">0x3</span>; _0x3c7880 &gt;= <span class="number">0x0</span>; _0x3c7880--) &#123;</span><br><span class="line">		<span class="keyword">let</span> _0x43811c = (_0xad4470 &gt;&gt; <span class="number">0x8</span> * _0x3c7880 &amp; <span class="number">0xff</span>)[<span class="string">&#x27;toString&#x27;</span>](<span class="number">0x10</span>);</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">parseInt</span>(<span class="string">&#x27;0x&#x27;</span> + _0x43811c) &lt;= <span class="number">0xf</span>) _0x43811c = <span class="string">&#x27;0&#x27;</span> + _0x43811c;</span><br><span class="line">		_0x4176bf += _0x43811c;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> _0x4176bf;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Base16ToLong</span>(<span class="params">_0x203413</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">const</span> _0x27c0c4 = _0x22517d;</span><br><span class="line">	<span class="keyword">let</span> _0x48728d = <span class="number">0x0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">let</span> _0x239fca = <span class="number">0x0</span>; _0x239fca &lt; <span class="number">0x8</span>; _0x239fca += <span class="number">0x2</span>) &#123;</span><br><span class="line">		<span class="keyword">let</span> _0x24e56c = <span class="built_in">parseInt</span>(<span class="string">&#x27;0x&#x27;</span> + _0x203413[_0x27c0c4(<span class="number">0x1a6</span>)](_0x239fca, _0x239fca + <span class="number">0x2</span>));</span><br><span class="line">		_0x48728d = (_0x48728d &lt;&lt; <span class="number">0x8</span>) + _0x24e56c;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> _0x48728d;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_0x381b</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">const</span> _0x4af9ee = [<span class="string">&#x27;encrypt&#x27;</span>, <span class="string">&#x27;33MGcQht&#x27;</span>, <span class="string">&#x27;6fbde674819a59bfa12092565b4ca2a7a11dc670c678681daf4afb6704b82f0c&#x27;</span>, <span class="string">&#x27;14021KbbewD&#x27;</span>, <span class="string">&#x27;charCodeAt&#x27;</span>, <span class="string">&#x27;808heYYJt&#x27;</span>, <span class="string">&#x27;5DlyrGX&#x27;</span>, <span class="string">&#x27;552oZzIQH&#x27;</span>, <span class="string">&#x27;fromCharCode&#x27;</span>, <span class="string">&#x27;356IjESGA&#x27;</span>, <span class="string">&#x27;784713mdLTBv&#x27;</span>, <span class="string">&#x27;2529060PvKScd&#x27;</span>, <span class="string">&#x27;805548mjjthm&#x27;</span>, <span class="string">&#x27;844848vFCypf&#x27;</span>, <span class="string">&#x27;4bIkkcJ&#x27;</span>, <span class="string">&#x27;1356853149054377&#x27;</span>, <span class="string">&#x27;length&#x27;</span>, <span class="string">&#x27;slice&#x27;</span>, <span class="string">&#x27;1720848ZSQDkr&#x27;</span>];</span><br><span class="line">	_0x381b = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> _0x4af9ee;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> _0x381b();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">LongToStr4</span>(<span class="params">_0x2f2e9e</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">const</span> _0x416d95 = _0x22517d,</span><br><span class="line">	_0x106afc = <span class="built_in">String</span>[_0x416d95(<span class="number">0x1b0</span>)](_0x2f2e9e &amp; <span class="number">0xff</span>, _0x2f2e9e &gt;&gt; <span class="number">0x8</span> &amp; <span class="number">0xff</span>, _0x2f2e9e &gt;&gt; <span class="number">0x10</span> &amp; <span class="number">0xff</span>, _0x2f2e9e &gt;&gt; <span class="number">0x18</span> &amp; <span class="number">0xff</span>);</span><br><span class="line">	<span class="keyword">return</span> _0x106afc;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gyflagh</span>(<span class="params">_0x111955</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">const</span> _0x50051f = _0x22517d;</span><br><span class="line">	<span class="keyword">let</span> _0x3b790d = _0x111955[_0x50051f(<span class="number">0x1a8</span>)](_0x50051f(<span class="number">0x1b7</span>));</span><br><span class="line">	<span class="keyword">if</span> (_0x3b790d === _0x50051f(<span class="number">0x1aa</span>)) <span class="keyword">return</span> !! [];</span><br><span class="line">	<span class="keyword">return</span> ! [];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个js被混淆过, 可读性很差. 然后在网站找下有没有反混淆工具, 无果…<br>那就自己来吧, 一顿分析猛如虎, 《易得》：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span>.prototype.encrypt = <span class="function"><span class="keyword">function</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">const</span> l = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">0x2</span>),</span><br><span class="line">	v = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">0x4</span>);</span><br><span class="line">	<span class="keyword">let</span> r = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">	plaintext = <span class="built_in">escape</span>(<span class="built_in">this</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0x0</span>; i &lt; <span class="number">0x4</span>; i++) v[i] = Str4ToLong(s.slice(i * <span class="number">0x4</span>, (i + <span class="number">0x1</span>) * <span class="number">0x4</span>));</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; plaintext.length; i += <span class="number">8</span>) &#123;</span><br><span class="line">		l[<span class="number">0</span>] = Str4ToLong(plaintext.slice(i, i + <span class="number">0x4</span>)),</span><br><span class="line">		l[<span class="number">1</span>] = Str4ToLong(plaintext.slice(i + <span class="number">0x4</span>, i + <span class="number">0x8</span>)),</span><br><span class="line">		code(l, v),</span><br><span class="line">		r += LongToBase16(l[<span class="number">0x0</span>]) + LongToBase16(l[<span class="number">0x1</span>]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> r;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">String</span>.prototype.decrypt = <span class="function"><span class="keyword">function</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">const</span> l = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">0x2</span>),</span><br><span class="line">	v = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">0x4</span>);</span><br><span class="line">	<span class="keyword">let</span> r = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">	plaintext = <span class="built_in">escape</span>(<span class="built_in">this</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0x0</span>; i &lt; <span class="number">0x4</span>; i++) v[i] = Str4ToLong(s.slice(i * <span class="number">0x4</span>, (i + <span class="number">0x1</span>) * <span class="number">0x4</span>));</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; plaintext.length; i += <span class="number">16</span>) &#123;</span><br><span class="line">		l[<span class="number">0</span>] = Base16ToLong(plaintext.slice(i, i + <span class="number">8</span>)),</span><br><span class="line">		l[<span class="number">1</span>] = Base16ToLong(plaintext.slice(i + <span class="number">8</span>, i + <span class="number">16</span>)),</span><br><span class="line">		decode(l, v),</span><br><span class="line">		r += LongToStr4(l[<span class="number">0x0</span>]) + LongToStr4(l[<span class="number">0x1</span>]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> r;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">code</span>(<span class="params">l, v</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">let</span> l0 = l[<span class="number">0x0</span>],</span><br><span class="line">	l1 = l[<span class="number">0x1</span>];</span><br><span class="line">	<span class="keyword">const</span> _0x540f95 = <span class="number">0x9E3779B9</span>,</span><br><span class="line">	_0x2bdc23 = _0x540f95 * <span class="number">0x20</span>;</span><br><span class="line">	<span class="keyword">let</span> i = <span class="number">0x0</span>;</span><br><span class="line">	<span class="keyword">while</span> (i != _0x2bdc23) &#123;</span><br><span class="line">		l0 += (l1 &lt;&lt; <span class="number">0x4</span> ^ l1 &gt;&gt;&gt; <span class="number">0x5</span>) + l1 ^ i + v[i &amp; <span class="number">0x3</span>],</span><br><span class="line">		i += _0x540f95,</span><br><span class="line">		l1 += (l0 &lt;&lt; <span class="number">0x4</span> ^ l0 &gt;&gt;&gt; <span class="number">0x5</span>) + l0 ^ i + v[i &gt;&gt;&gt; <span class="number">0xb</span> &amp; <span class="number">0x3</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	l[<span class="number">0x0</span>] = l0,</span><br><span class="line">	l[<span class="number">0x1</span>] = l1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decode</span>(<span class="params">l, v</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">let</span> l0 = l[<span class="number">0x0</span>],</span><br><span class="line">	l1 = l[<span class="number">0x1</span>];</span><br><span class="line">	<span class="keyword">const</span> _0x540f95 = <span class="number">0x9E3779B9</span>,</span><br><span class="line">	_0x2bdc23 = _0x540f95 * <span class="number">0x20</span>;</span><br><span class="line">	<span class="keyword">let</span> i = _0x2bdc23;</span><br><span class="line">	<span class="keyword">while</span> (i != <span class="number">0</span>) &#123;</span><br><span class="line">		l1 -= (l0 &lt;&lt; <span class="number">0x4</span> ^ l0 &gt;&gt;&gt; <span class="number">0x5</span>) + l0 ^ i + v[i &gt;&gt;&gt; <span class="number">0xb</span> &amp; <span class="number">0x3</span>];</span><br><span class="line">		i -= _0x540f95;</span><br><span class="line">		l0 -= (l1 &lt;&lt; <span class="number">0x4</span> ^ l1 &gt;&gt;&gt; <span class="number">0x5</span>) + l1 ^ i + v[i &amp; <span class="number">0x3</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	l[<span class="number">0x0</span>] = l0,</span><br><span class="line">	l[<span class="number">0x1</span>] = l1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Str4ToLong</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">let</span> r = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) r |= s.charCodeAt(i) &lt;&lt; i * <span class="number">0x8</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">isNaN</span>(r) ? <span class="number">0</span>: r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">LongToBase16</span>(<span class="params">l</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">let</span> s = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0x3</span>; i &gt;= <span class="number">0x0</span>; i--) &#123;</span><br><span class="line">		<span class="keyword">let</span> _0x43811c = (l &gt;&gt; <span class="number">0x8</span> * i &amp; <span class="number">0xff</span>)[<span class="string">&#x27;toString&#x27;</span>](<span class="number">0x10</span>);</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">parseInt</span>(<span class="string">&#x27;0x&#x27;</span> + _0x43811c) &lt;= <span class="number">0xf</span>) _0x43811c = <span class="string">&#x27;0&#x27;</span> + _0x43811c;</span><br><span class="line">		s += _0x43811c;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Base16ToLong</span>(<span class="params">_0x203413</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">let</span> _0x48728d = <span class="number">0x0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">let</span> _0x239fca = <span class="number">0x0</span>; _0x239fca &lt; <span class="number">0x8</span>; _0x239fca += <span class="number">0x2</span>) &#123;</span><br><span class="line">		<span class="keyword">let</span> _0x24e56c = <span class="built_in">parseInt</span>(<span class="string">&#x27;0x&#x27;</span> + _0x203413.slice(_0x239fca, _0x239fca + <span class="number">0x2</span>));</span><br><span class="line">		_0x48728d = (_0x48728d &lt;&lt; <span class="number">0x8</span>) + _0x24e56c;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> _0x48728d;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">LongToStr4</span>(<span class="params">_0x2f2e9e</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">const</span> _0x106afc = <span class="built_in">String</span>.fromCharCode(_0x2f2e9e &amp; <span class="number">0xff</span>, _0x2f2e9e &gt;&gt; <span class="number">0x8</span> &amp; <span class="number">0xff</span>, _0x2f2e9e &gt;&gt; <span class="number">0x10</span> &amp; <span class="number">0xff</span>, _0x2f2e9e &gt;&gt; <span class="number">0x18</span> &amp; <span class="number">0xff</span>);</span><br><span class="line">	<span class="keyword">return</span> _0x106afc;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gyflagh</span>(<span class="params">flag</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">let</span> e = flag.encrypt(<span class="string">&#x27;1356853149054377&#x27;</span>);</span><br><span class="line">	<span class="keyword">if</span> (e === <span class="string">&#x27;6fbde674819a59bfa12092565b4ca2a7a11dc670c678681daf4afb6704b82f0c&#x27;</span>) <span class="keyword">return</span> !! [];</span><br><span class="line">	<span class="keyword">return</span> ! [];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> e = <span class="string">&#x27;6fbde674819a59bfa12092565b4ca2a7a11dc670c678681daf4afb6704b82f0c&#x27;</span>.decrypt(<span class="string">&#x27;1356853149054377&#x27;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(e);</span><br><span class="line"><span class="built_in">console</span>.log(gyflagh(e));</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>然后结果包上flag{}就行.</p>
<h2 id="超-OI-的-Writeup-模拟器-1"><a href="#超-OI-的-Writeup-模拟器-1" class="headerlink" title="超 OI 的 Writeup 模拟器 #1"></a>超 OI 的 Writeup 模拟器 #1</h2><p>这个我是人工反编译的, 不会写脚本, 后面十五小题就没看了.<br>快进到关键函数, 发现这个函数被扁平化了:<br><img src="/img/loading.svg" data-original="/pictures/hackergame_2021_obv_1.jpg" alt="流程图"></p>
<p>然后分析了很久, 最后还是坐不住换了个方法. 由于i与输入参数无关, 那我们就在每个分支打断点, 然后跑一次查看流程, 结果是1跑了十一次, 2跑了一次:<br><img src="/img/loading.svg" data-original="/pictures/hackergame_2021_obv_2.jpg" alt="代码"></p>
<p>然后写解密代码:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">N = <span class="number">0x10000000000000000</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exgcd</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>: <span class="keyword">return</span> a, <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    d, x, y = exgcd(b, a % b)</span><br><span class="line">    <span class="keyword">return</span> d, y, x - y * <span class="built_in">int</span>(a / b)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve</span>(<span class="params">a, b, n</span>):</span></span><br><span class="line">    _, x, _ = exgcd(a, n)</span><br><span class="line">    <span class="keyword">return</span> x * b % n</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">backward</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    <span class="keyword">return</span> solve((<span class="number">0x21DBA181B3901BAE</span> - a * <span class="number">0x58C5EC8BD3B2A4AA</span>) + <span class="number">1</span>, b, N), a</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">toascii</span>(<span class="params">n</span>):</span></span><br><span class="line">    s = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        s = s + <span class="built_in">chr</span>(n &amp; <span class="number">0xFF</span>)</span><br><span class="line">        n = n &gt;&gt; <span class="number">8</span></span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line">a = solve(<span class="number">0xD71E1226CB47657F</span>, <span class="number">0xCB8D3677A9C1A3B2</span>, N)</span><br><span class="line">b = solve(<span class="number">0xC5E13B34BC5473E3</span>, <span class="number">0xA9C10ABDFFAB71F6</span>, N)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">11</span>):</span><br><span class="line">    a, b = backward(a, b)</span><br><span class="line"><span class="built_in">print</span>(toascii(a) + toascii(b))</span><br><span class="line"><span class="comment"># RrMAb3N4zXNYfOyT</span></span><br></pre></td></tr></table></figure></p>
<p>外面包上flag{}即可.</p>
<h2 id="密码生成器"><a href="#密码生成器" class="headerlink" title="密码生成器"></a>密码生成器</h2><p>题目意思大概是让我们从时间反向推出密码生成器的密码, 注意这里有个魔鬼细节: “差了八个小时”.<br>先不管啦, 直接分析网站上给出的密码生成器.<br>IDA打开, 发现很多代码. spy++看窗口类名, 呃好像是Qt写的, 感觉就不会了(立一个反向flag哈哈)<br>程序一般生成的是伪随机数, 也就是根据时间, CPU温度什么的用一系列算法生成随机数.<br>先找了下导入表中有没有srand函数和rand函数, 只有一个结果, 但打开看发现那个不是我们想要的.<br>再找一下time, 有一个_time64, 点开看发现很可疑. 在这里下个断点, 运行程序发现一切正常, 点生成密码按钮命中断点.<br>那应该就是这里了. 另外找一下ABC…XYZ这个字符串, 有十几个, 但到Z结束的只有前两个, 正是我们想要的, 旁边的特殊字符表和数字表也找到了:<br><img src="/img/loading.svg" data-original="/pictures/hackergame_2021_pwdgen_1.jpg" alt="字母表"><br>然后开始看有time64的那个函数(为了阅读方便一些符号已经重命名而且添加了注释):<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// local variable allocation has failed, the output may be wrong!</span></span><br><span class="line"><span class="comment">// positive sp value has been detected, the output may be wrong!</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> **__fastcall <span class="title">gen_rand</span><span class="params">(<span class="keyword">void</span> *a1, <span class="keyword">void</span> *a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v2; <span class="comment">// rdx</span></span><br><span class="line">  <span class="keyword">void</span> **v3; <span class="comment">// rcx</span></span><br><span class="line">  <span class="keyword">void</span> **v4; <span class="comment">// rbp</span></span><br><span class="line">  __int64 v5; <span class="comment">// rsi</span></span><br><span class="line">  <span class="keyword">bool</span> v6; <span class="comment">// zf</span></span><br><span class="line">  DWORD v7; <span class="comment">// eax</span></span><br><span class="line">  __int64 v8; <span class="comment">// rdx</span></span><br><span class="line">  DWORD v9; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">int</span> v10; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// er12</span></span><br><span class="line">  __int64 idx; <span class="comment">// rcx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v13; <span class="comment">// edx</span></span><br><span class="line">  __int64 table_1; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">bool</span> v15; <span class="comment">// cc</span></span><br><span class="line">  <span class="keyword">wchar_t</span> *v16; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">wchar_t</span> v17; <span class="comment">// r14</span></span><br><span class="line">  <span class="keyword">float</span> rand; <span class="comment">// xmm0_4</span></span><br><span class="line">  <span class="keyword">float</span> v19; <span class="comment">// xmm6_4</span></span><br><span class="line">  <span class="keyword">float</span> v20; <span class="comment">// xmm0_4</span></span><br><span class="line">  <span class="keyword">int</span> len; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">int</span> pos; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">bool</span> v23; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">void</span> *v24; <span class="comment">// rcx</span></span><br><span class="line">  <span class="keyword">signed</span> __int32 v25; <span class="comment">// et0</span></span><br><span class="line">  <span class="keyword">wchar_t</span> **v26; <span class="comment">// rcx</span></span><br><span class="line">  <span class="keyword">signed</span> __int32 v27; <span class="comment">// et0</span></span><br><span class="line">  <span class="keyword">wchar_t</span> **table; <span class="comment">// [rsp+28h] [rbp-13F0h] BYREF</span></span><br><span class="line">  DWORD ptable[<span class="number">624</span>]; <span class="comment">// [rsp+30h] [rbp-13E8h] BYREF</span></span><br><span class="line">  DWORD v31[<span class="number">624</span>]; <span class="comment">// [rsp+30h] [rbp-13E8h] FORCED BYREF</span></span><br><span class="line">  __int64 v32; <span class="comment">// [rsp+9F0h] [rbp-A28h]</span></span><br><span class="line">  <span class="keyword">float</span> v33; <span class="comment">// [rsp+A00h] [rbp-A18h] OVERLAPPED</span></span><br><span class="line">  <span class="keyword">float</span> v34; <span class="comment">// [rsp+A04h] [rbp-A14h] 0</span></span><br><span class="line">  DWORD randobj[<span class="number">640</span>]; <span class="comment">// [rsp+A08h] [rbp-A10h] BYREF</span></span><br><span class="line"></span><br><span class="line">  ((<span class="keyword">void</span> (__fastcall *)(<span class="keyword">void</span> *, <span class="keyword">void</span> *))sub_446270)(a1, a2);</span><br><span class="line">  v4 = v3;</span><br><span class="line">  v5 = v2;</span><br><span class="line">  <span class="keyword">if</span> ( *(<span class="keyword">int</span> *)(v2 + <span class="number">32</span>) &lt;= <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    *v3 = (<span class="keyword">void</span> *)sub_B21B40(byte_F58069, <span class="number">0x1B</span>u);</span><br><span class="line">    <span class="keyword">return</span> v4;</span><br><span class="line">  &#125;</span><br><span class="line">  v6 = *(_BYTE *)(v2 + <span class="number">36</span>) == <span class="number">0</span>;</span><br><span class="line">  table = (<span class="keyword">wchar_t</span> **)dword_11E9580;            <span class="comment">// 字母表</span></span><br><span class="line">  <span class="keyword">if</span> ( !v6 )</span><br><span class="line">    str_append((<span class="keyword">void</span> **)&amp;table, (__int64 *)v2);</span><br><span class="line">  <span class="keyword">if</span> ( *(_BYTE *)(v5 + <span class="number">37</span>) )</span><br><span class="line">    str_append((<span class="keyword">void</span> **)&amp;table, (__int64 *)(v5 + <span class="number">8</span>));</span><br><span class="line">  <span class="keyword">if</span> ( *(_BYTE *)(v5 + <span class="number">38</span>) )</span><br><span class="line">    str_append((<span class="keyword">void</span> **)&amp;table, (__int64 *)(v5 + <span class="number">16</span>));</span><br><span class="line">  <span class="keyword">if</span> ( *(_BYTE *)(v5 + <span class="number">39</span>) )</span><br><span class="line">    str_append((<span class="keyword">void</span> **)&amp;table, (__int64 *)(v5 + <span class="number">24</span>));</span><br><span class="line">  v7 = time64(<span class="number">0</span>i64);</span><br><span class="line">  v8 = <span class="number">1</span>i64;</span><br><span class="line">  v9 = v7;</span><br><span class="line">  ptable[<span class="number">0</span>] = v7;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    ptable[v8] = v8 + <span class="number">1812433253</span> * (v9 ^ (v9 &gt;&gt; <span class="number">30</span>));<span class="comment">// 624次?</span></span><br><span class="line">    <span class="keyword">if</span> ( ++v8 == <span class="number">624</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v9 = ptable[v8 - <span class="number">1</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  v32 = <span class="number">624</span>i64;</span><br><span class="line">  *(_QWORD *)&amp;v33 = <span class="number">0x3F80000000000000</span>i64;      <span class="comment">// float(1.0), 0</span></span><br><span class="line">  <span class="built_in">memcpy</span>(randobj, ptable, <span class="number">0x9C8</span>ui64);           <span class="comment">// copy all randoms</span></span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = *(_DWORD *)(v5 + <span class="number">32</span>);</span><br><span class="line">    *(_QWORD *)v31 = dword_11E9580;</span><br><span class="line">    <span class="keyword">if</span> ( v10 &gt; <span class="number">0</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v11 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v17 = <span class="number">0</span>;</span><br><span class="line">        rand = get_rand(randobj);</span><br><span class="line">        v19 = (<span class="keyword">float</span>)(rand * (<span class="keyword">float</span>)(v34 - v33)) + v33;<span class="comment">// v19=1-rand</span></span><br><span class="line">        v20 = get_rand(randobj);</span><br><span class="line">        len = *((_DWORD *)table + <span class="number">1</span>);</span><br><span class="line">        pos = (<span class="keyword">int</span>)(<span class="keyword">float</span>)((<span class="keyword">float</span>)((<span class="keyword">float</span>)((<span class="keyword">float</span>)(v20 * (<span class="keyword">float</span>)(v34 - v33)) + v33) * v19) * (<span class="keyword">float</span>)len);</span><br><span class="line">        <span class="keyword">if</span> ( pos &lt; len )</span><br><span class="line">          v17 = *(_WORD *)((<span class="keyword">char</span> *)table + <span class="number">2</span> * pos + (_QWORD)table[<span class="number">2</span>]);</span><br><span class="line">        table_1 = *(_QWORD *)v31;</span><br><span class="line">        <span class="keyword">if</span> ( **(_DWORD **)v31 &gt; <span class="number">1u</span> )</span><br><span class="line">          <span class="keyword">break</span>;                                <span class="comment">// fail</span></span><br><span class="line">        idx = *(<span class="keyword">int</span> *)(*(_QWORD *)v31 + <span class="number">4</span>i64);</span><br><span class="line">        v13 = idx + <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> ( (<span class="keyword">int</span>)idx + <span class="number">2</span> &gt; (*(_DWORD *)(*(_QWORD *)v31 + <span class="number">8</span>i64) &amp; <span class="number">0x7FFFFFFF</span>u) )</span><br><span class="line">          <span class="keyword">goto</span> LABEL_17;</span><br><span class="line">gen:                                            <span class="comment">// char generation loop</span></span><br><span class="line">        ++v11;</span><br><span class="line">        *(_DWORD *)(table_1 + <span class="number">4</span>) = idx + <span class="number">1</span>;</span><br><span class="line">        v15 = *(_DWORD *)(v5 + <span class="number">32</span>) &lt;= v11;</span><br><span class="line">        v16 = (<span class="keyword">wchar_t</span> *)(*(_QWORD *)(table_1 + <span class="number">16</span>) + table_1 + <span class="number">2</span> * idx);</span><br><span class="line">        *v16 = v17;                             <span class="comment">// the charactor</span></span><br><span class="line">        v16[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v15 )</span><br><span class="line">          <span class="keyword">goto</span> LABEL_23;</span><br><span class="line">      &#125;</span><br><span class="line">      v13 = *(_DWORD *)(*(_QWORD *)v31 + <span class="number">4</span>i64) + <span class="number">2</span>;</span><br><span class="line">LABEL_17:</span><br><span class="line">      sub_B20AD0((<span class="keyword">void</span> **)v31, v13, <span class="number">1</span>);</span><br><span class="line">      table_1 = *(_QWORD *)v31;</span><br><span class="line">      idx = *(<span class="keyword">int</span> *)(*(_QWORD *)v31 + <span class="number">4</span>i64);</span><br><span class="line">      <span class="keyword">goto</span> gen;</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_23:</span><br><span class="line">    v23 = sub_BC91C0(v5, (__int64 *)v31);</span><br><span class="line">    v24 = *(<span class="keyword">void</span> **)v31;</span><br><span class="line">    <span class="keyword">if</span> ( v23 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( **(_DWORD **)v31 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( **(_DWORD **)v31 == <span class="number">-1</span> )</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">      v25 = _InterlockedSub(*(<span class="keyword">volatile</span> <span class="keyword">signed</span> __int32 **)v31, <span class="number">1u</span>);</span><br><span class="line">      v24 = *(<span class="keyword">void</span> **)v31;</span><br><span class="line">      <span class="keyword">if</span> ( v25 )</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    sub_64A030(v24);</span><br><span class="line">  &#125;                                             <span class="comment">// gen end</span></span><br><span class="line">  *v4 = *(<span class="keyword">void</span> **)v31;</span><br><span class="line">  *(_QWORD *)v31 = dword_11E9580;</span><br><span class="line">  v26 = table;</span><br><span class="line">  <span class="keyword">if</span> ( !*(_DWORD *)table</span><br><span class="line">    || *(_DWORD *)table != <span class="number">-1</span> &amp;&amp; (v27 = _InterlockedSub((<span class="keyword">volatile</span> <span class="keyword">signed</span> __int32 *)table, <span class="number">1u</span>), v26 = table, !v27) )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_64A030(v26);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v4;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>个人感觉C++的程序比C的难读很多, 一开始没什么头绪, 然后就放了几天.<br>周四把这个函数理了一下, 抱着尝试的态度去网上找了下算法中出现的1812433253这个数字.<br>然后恍然大悟, 这是梅森旋转算法, (C库里那个rand是线性同余算法, 和这个一样都属于不安全的随机数生成算法)<br>程序中的大小为624的数组印证了我的猜想.<br>然后就硬看, 生成过程大概是:</p>
<ul>
<li>检查4个复选框, 把4个字母表拼成一个长字符串, 在这题中4种字符都要有.</li>
<li>初始化梅森旋转算法</li>
<li>生成密码(单个字符<code>c = rand() * rand() * len(alphatable)</code>, 所以取到字母表的前面的字母概率较大)</li>
<li>如果密码没有同时包含4种字符, 全部推倒重来</li>
</ul>
<p>最后一条规则看代码没看出来. 运行程序把4种类型都选上, 长度改成3(构造不可能事件). 结果程序一直在get_rand, 大胆猜测推倒重来这个规则, 结果验证后发现这是对的. <del>我把它叫做假说-演绎法(</del><br>写解密算法就OK:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">lst = []</span><br><span class="line">idx = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">srand</span>(<span class="params">t</span>):</span></span><br><span class="line">    <span class="keyword">global</span> idx</span><br><span class="line">    idx = <span class="number">0</span></span><br><span class="line">    lst.clear()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">        lst.append(t)</span><br><span class="line">        t = (<span class="number">1812433253</span> * (t ^ (t &gt;&gt; <span class="number">30</span>)) + i + <span class="number">1</span>) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rand</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">step</span>():</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">            y = (lst[i] &amp; <span class="number">0x80000000</span>) + (lst[(i + <span class="number">1</span>) % <span class="number">624</span>] &amp; <span class="number">0x7FFFFFFF</span>)</span><br><span class="line">            lst[i] = lst[(i + <span class="number">397</span>) % <span class="number">624</span>] ^ (y &gt;&gt; <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">if</span> (y &amp; <span class="number">1</span>) != <span class="number">0</span>: lst[i] = lst[i] ^ <span class="number">2567483615</span></span><br><span class="line">    <span class="keyword">global</span> idx</span><br><span class="line">    <span class="keyword">if</span> idx == <span class="number">0</span>: step()</span><br><span class="line">    y = lst[idx]</span><br><span class="line">    y = y ^ (y &gt;&gt; <span class="number">11</span>)</span><br><span class="line">    y = y ^ ((y &lt;&lt; <span class="number">7</span>) &amp; <span class="number">2636928640</span>)</span><br><span class="line">    y = y ^ ((y &lt;&lt; <span class="number">15</span>) &amp; <span class="number">4022730752</span>)</span><br><span class="line">    y = y ^ (y &gt;&gt; <span class="number">18</span>)</span><br><span class="line">    idx = (idx + <span class="number">1</span>) % <span class="number">624</span></span><br><span class="line">    <span class="keyword">return</span> y / <span class="number">0x100000000</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen</span>(<span class="params">time</span>):</span></span><br><span class="line">    <span class="keyword">if</span> time != -<span class="number">1</span>: srand(time)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">truerand</span>():</span></span><br><span class="line">        x = rand()</span><br><span class="line">        y = rand()</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">int</span>(x * y * <span class="number">94</span>)</span><br><span class="line">    alpha = <span class="string">&#x27;&#x27;&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890~!@#$%^&amp;*()_+`-=[]\\&#123;&#125;|;&#x27;:\&quot;,./&lt;&gt;?&#x27;&#x27;&#x27;</span></span><br><span class="line">    stat = [<span class="number">3</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">94</span>)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">        stat[i] = <span class="number">0</span></span><br><span class="line">        stat[i + <span class="number">26</span>] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        stat[i + <span class="number">52</span>] = <span class="number">2</span></span><br><span class="line">    r, vt = <span class="string">&#x27;&#x27;</span>, [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        x = truerand()</span><br><span class="line">        y = stat[x]</span><br><span class="line">        vt[y] = vt[y] + <span class="number">1</span></span><br><span class="line">        r = r + alpha[x]</span><br><span class="line">    <span class="keyword">if</span> vt[<span class="number">0</span>] == <span class="number">0</span> <span class="keyword">or</span> vt[<span class="number">1</span>] == <span class="number">0</span> <span class="keyword">or</span> vt[<span class="number">2</span>] == <span class="number">0</span> <span class="keyword">or</span> vt[<span class="number">3</span>] == <span class="number">0</span>: r = gen(-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line">csrf = <span class="string">&#x27;4uU4gCiPKItbRLPCOwNZcRhYzknHuWJHklxxQv5LohsRmjwpcyHGzGrhnQeDCSdd&#x27;</span></span><br><span class="line">sid = <span class="string">&#x27;eyJ0b2tlbiI6IjY4OTpNRVFDSUdhNkFIQmFqS1ZqZ0cyUTJpeWhtSkpUVi9hT0dPYzArV28zL1VReVpWbjFBaUFRd0k1b0R0dWdiSGQ4U1ZTTEFDeTgrTXEvZmZvS1AwMlZXQ0lDbkp1M3dBPT0ifQ:1mg5t5:2-_5RzMfjBfLBtAP1B21xcxzNuY3mka0XBvViLoB_hM&#x27;</span></span><br><span class="line">head = <span class="string">&#x27;&lt;input type=&quot;hidden&quot; name=&quot;csrfmiddlewaretoken&quot; value=&quot;&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span>(<span class="params">k</span>):</span></span><br><span class="line">    cookie = &#123;<span class="string">&#x27;csrftoken&#x27;</span>: csrf, <span class="string">&#x27;sessionid&#x27;</span>: sid&#125;</span><br><span class="line">    r = requests.get(<span class="string">&#x27;http://202.38.93.111:15002/login&#x27;</span>, cookies=cookie)</span><br><span class="line">    p = r.text.find(head) + <span class="built_in">len</span>(head)</span><br><span class="line">    q = r.text.find(<span class="string">&#x27;&quot;&#x27;</span>, p)</span><br><span class="line">    csrf_mid = r.text[p:q]</span><br><span class="line">    r = requests.post(<span class="string">&#x27;http://202.38.93.111:15002/login&#x27;</span>, cookies=cookie, data=&#123;<span class="string">&#x27;csrfmiddlewaretoken&#x27;</span>: csrf_mid, <span class="string">&#x27;username&#x27;</span>: <span class="string">&#x27;admin&#x27;</span>, <span class="string">&#x27;password&#x27;</span>: k&#125;)</span><br><span class="line">    <span class="keyword">return</span> r.text.find(<span class="string">&#x27;用户名或密码错误&#x27;</span>) == -<span class="number">1</span></span><br><span class="line"></span><br><span class="line">t = <span class="built_in">int</span>(time.mktime(time.strptime(<span class="string">&#x27;2021-09-22 23:12&#x27;</span>, <span class="string">&#x27;%Y-%m-%d %H:%M&#x27;</span>)))</span><br><span class="line">dt = <span class="number">0</span></span><br><span class="line">d = <span class="number">8</span> * <span class="number">3600</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="built_in">print</span>(dt)</span><br><span class="line">    k = gen(t - dt + d)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">str</span>(t - dt + d) + <span class="string">&#x27;  -&gt;  &#x27;</span> + k + <span class="string">&#x27;  ...  &#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> test(k):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;failed&#x27;</span>)</span><br><span class="line">    k = gen(t - dt)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">str</span>(t - dt) + <span class="string">&#x27;  -&gt;  &#x27;</span> + k + <span class="string">&#x27;  ...  &#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> test(k):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;failed&#x27;</span>)</span><br><span class="line">    k = gen(t - dt - d)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">str</span>(t - dt - d) + <span class="string">&#x27;  -&gt;  &#x27;</span> + k + <span class="string">&#x27;  ...  &#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> test(k):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;failed&#x27;</span>)</span><br><span class="line">    dt = dt + <span class="number">1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>可能还是技术不足, 之前不知道session这个东西, 就拿csrf去充当参数. 不过, 问题不大<br>脚本在dt为六十几的时候命中密码, 当时超级兴奋!!!</p>
<p>但是看了官方WP的做法后人傻了, 原来就我在逆向生成算法555</p>
<h2 id="更多"><a href="#更多" class="headerlink" title="更多"></a>更多</h2><p>星期八再说(</p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script></article><div class="post-copyright"><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://killtimer0.github.io/2021/11/04/Hackergame2021/">https://killtimer0.github.io/2021/11/04/Hackergame2021/</a></span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/reverse/">reverse</a><a class="post-meta__tags" href="/tags/ctf/">ctf</a><a class="post-meta__tags" href="/tags/pwn/">pwn</a><a class="post-meta__tags" href="/tags/web/">web</a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/01/15/XDCTF/"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">“抗疫”CTF题解</div></div></a></div><div class="next-post pull-right"><a href="/2021/09/26/moectf/"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">moectf 题解记录</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/01/15/XDCTF/" title="“抗疫”CTF题解"><img class="cover" src="/img/loading.svg" data-original="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-15</div><div class="title">“抗疫”CTF题解</div></div></a></div><div><a href="/2021/09/26/moectf/" title="moectf 题解记录"><img class="cover" src="/img/loading.svg" data-original="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-09-26</div><div class="title">moectf 题解记录</div></div></a></div><div><a href="/2021/09/20/test-sort/" title="C中的qsort真的比C++中的std::sort快吗?"><img class="cover" src="/img/loading.svg" data-original="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-09-20</div><div class="title">C中的qsort真的比C++中的std::sort快吗?</div></div></a></div><div><a href="/2022/09/21/Mixed01/" title="大杂烩"><img class="cover" src="/img/loading.svg" data-original="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-21</div><div class="title">大杂烩</div></div></a></div><div><a href="/2022/08/30/VPhone-Reverse/" title="光速虚拟机逆向分析 --verbose"><img class="cover" src="/img/loading.svg" data-original="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-30</div><div class="title">光速虚拟机逆向分析 --verbose</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/loading.svg" data-original="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">KillTimer</div><div class="author-info__description">休息一下吧，去看个书好不好</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">9</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/killtimer0" target="_blank" title="GitHub"><i class="iconfont icon-github"></i></a><a class="social-icon" href="mailto:1837009039@qq.com" target="_blank" title="QQ"><i class="iconfont icon-qq"></i></a><a class="social-icon" href="https://www.bilibili.com" target="_blank" title="哔哩哔哩"><i class="iconfont icon-bilibili"></i></a><a class="social-icon" href="/game.html" target="_blank" title="彩蛋"><i class="iconfont icon-egg-c"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3"><span class="toc-number">1.</span> <span class="toc-text">题解</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E5%88%B6%E5%8D%81%E5%85%AD%E2%80%94%E2%80%94%E5%8F%82%E4%B8%8A"><span class="toc-number">1.1.</span> <span class="toc-text">进制十六——参上</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%BB%E5%90%A7%EF%BC%81%E8%BF%BD%E5%AF%BB%E8%87%AA%E7%94%B1%E7%9A%84%E7%94%B5%E6%B3%A2"><span class="toc-number">1.2.</span> <span class="toc-text">去吧！追寻自由的电波</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%96%E7%93%9C"><span class="toc-number">1.3.</span> <span class="toc-text">卖瓜</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%8F%E6%98%8E%E7%9A%84%E6%96%87%E4%BB%B6"><span class="toc-number">1.4.</span> <span class="toc-text">透明的文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AD%E9%97%B4%E7%9C%81%E7%95%A5%E4%B8%80%E4%B8%87%E5%AD%97"><span class="toc-number">1.5.</span> <span class="toc-text">中间省略一万字</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Amnesia-1"><span class="toc-number">1.6.</span> <span class="toc-text">Amnesia #1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Micro-World"><span class="toc-number">1.7.</span> <span class="toc-text">Micro World</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#minecRaft"><span class="toc-number">1.8.</span> <span class="toc-text">minecRaft</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B6%85-OI-%E7%9A%84-Writeup-%E6%A8%A1%E6%8B%9F%E5%99%A8-1"><span class="toc-number">1.9.</span> <span class="toc-text">超 OI 的 Writeup 模拟器 #1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%86%E7%A0%81%E7%94%9F%E6%88%90%E5%99%A8"><span class="toc-number">1.10.</span> <span class="toc-text">密码生成器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9B%B4%E5%A4%9A"><span class="toc-number">1.11.</span> <span class="toc-text">更多</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By KillTimer</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>const script = document.createElement('script')
    script.src = 'https://cdn.bootcss.com/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML'
    script.id = 'MathJax-script'
    script.async = true
    script.onload = function(){
      MathJax.Hub.Config({
        showMathMenu: false,
        messageStyle: 'none',
        'HTML-CSS': {scale: 120},
        tex2jax: {
          inlineMath: [['$','$']],
          displayMath: [['$$','$$']],
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code', 'a', 'annotation', 'annotation-xml'],
        },
      });
    };
    document.head.appendChild(script)</script><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'forest',
      })
      false && mermaid.init()
    })
  }
}</script></div></div><script src="https://cdn.jsdelivr.net/npm/live2d-widget@^3.1.3/lib/L2Dwidget.min.js"></script><script>L2Dwidget.init({"pluginRootPath":"npm/live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"https://cdn.jsdelivr.net/npm/live2d-widget-model-hijiki@1.0.5/assets/hijiki.model.json"},"display":{"position":"right","width":87,"height":189,"hOffset":20},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.8},"log":false});</script><script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e&&e()},t.src!==i&&(n.src=i)}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this);</script></body></html>